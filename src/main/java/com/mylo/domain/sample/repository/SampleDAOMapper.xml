<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mylo.domain.sample.repository.SampleMapper">

    <select id="selectSampleList" resultType="com.mylo.domain.sample.model.Sample" parameterType="java.util.Map">
        SELECT idx
               , sample_url as sampleUrl
               , type_idx as cvMetaType
               , reg_date as regDate
               , update_date as updateDate
        FROM   cv_sample cv
        <where>
            <if test="keyword != null and keyword != ''">
                AND cv.sample_url = #{url}
            </if>
        </where>
        <if test="page != null">
            LIMIT #{page.firstIdx}, #{page.size}
        </if>
    </select>

    <select id="getTotalSampleCnt" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM   cv_sample
    </select>
    <insert id="insertSample" parameterType="com.mylo.domain.sample.model.Sample" useGeneratedKeys="true" keyProperty="idx" >
        INSERT INTO cv_sample(
            sample_url
            , type_idx
            , reg_date
            , update_date
        )
        VALUES (
            #{sampleUrl}
            , #{cvMetaType.code}
            , NOW()
            , NOW()
        )
    </insert>
</mapper>